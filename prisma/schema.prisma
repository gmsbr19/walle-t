generator client {
  provider = "prisma-client-js"
  output   = "../generated"
}

datasource db {
  provider = "sqlite"
}

enum TransactionType {
  INCOME
  EXPENSE
  TRANSFER
}

enum AccountType {
  WALLET
  BANK
  CREDIT_CARD
  INVESTMENT
}

model Account {
  id             Int         @id @default(autoincrement())
  name           String
  type           AccountType @default(BANK)
  initialBalance Decimal     @default(0)
  color          String?

  outgoingTransactions Transaction[] @relation("FromAccount")
  incomingTransactions Transaction[] @relation("ToAccount")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Category {
  id           Int      @id @default(autoincrement())
  name         String
  icon         String?
  color        String?
  monthlyBudget Decimal?

  parentId     Int?
  parent       Category?  @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children     Category[] @relation("CategoryHierarchy")

  transactions Transaction[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Transaction {
  id          Int             @id @default(autoincrement())
  description String
  amount      Decimal
  type        TransactionType
  
  date           DateTime
  competenceDate DateTime
  
  isPaid      Boolean  @default(false)

  categoryId  Int?
  category    Category? @relation(fields: [categoryId], references: [id])

  fromAccId   Int?
  fromAccount Account? @relation("FromAccount", fields: [fromAccId], references: [id])
  
  toAccId     Int?
  toAccount   Account? @relation("ToAccount", fields: [toAccId], references: [id])

  installmentCurrent Int? @default(1)
  installmentTotal   Int? @default(1)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
model Goal {
  id            Int      @id @default(autoincrement())
  name          String
  targetAmount  Decimal
  currentAmount Decimal  @default(0)
  deadline      DateTime?
  priority      Int      @default(1)

  isCompleted   Boolean  @default(false)

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}